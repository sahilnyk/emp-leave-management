{% extends "base_app.html" %}
{% block content %}

<div class="mb-4">
 <h4 class="mb-1">
  <i class="fas fa-hourglass-half me-2"></i>Pending Leave Requests
 </h4>
 <p class="text-muted mb-0" style="font-size:13px">Review and approve employee leave requests</p>
</div>

<div class="card">
 {% if leaves %}
  <div class="table-responsive">
   <table class="table mb-0">
    <thead>
     <tr>
      <th>Employee</th>
      <th>Leave Period</th>
      <th>Type</th>
      <th>Reason</th>
      <th>Submitted</th>
      <th style="width:200px">Action</th>
     </tr>
    </thead>
    <tbody>
     {% for l in leaves %}
     <tr>
      <td>
       <div class="fw-semibold">{{ l.user.get_full_name|default:l.user.username }}</div>
       <small class="text-muted">{{ l.user.email }}</small>
      </td>
      <td>
       <div style="font-size:13px">{{ l.start_date|date:"d M Y" }}</div>
       <small class="text-muted">to {{ l.end_date|date:"d M Y" }}</small>
      </td>
      <td>
       <span class="badge bg-secondary">{{ l.get_leave_type_display }}</span>
      </td>
      <td style="max-width:200px">
       <small>{{ l.reason|truncatewords:15 }}</small>
      </td>
      <td>
       <small class="text-muted">{{ l.created_at|date:"d M Y" }}</small>
      </td>
      <td>
       <form method="post" action="{% url 'leaves:approve_leave' l.id %}" class="mb-2">
        {% csrf_token %}
        <input name="comment" class="form-control form-control-sm mb-1" placeholder="Comment (optional)" style="font-size:12px">
        <button class="btn btn-sm btn-slate w-100" type="submit">
         <i class="fas fa-check me-1"></i>Approve
        </button>
       </form>
       <form method="post" action="{% url 'leaves:reject_leave' l.id %}">
        {% csrf_token %}
        <input name="comment" class="form-control form-control-sm mb-1" placeholder="Comment (optional)" style="font-size:12px">
        <button class="btn btn-sm w-100" type="submit" style="background:#ef4444;color:white;border:none;border-radius:6px;padding:0.375rem 0.5rem;font-weight:500">
         <i class="fas fa-times me-1"></i>Reject
        </button>
       </form>
      </td>
     </tr>
     {% endfor %}
    </tbody>
   </table>
  </div>
 {% else %}
  <div class="text-center text-muted py-5">
   <i class="fas fa-inbox fa-3x mb-3 d-block" style="opacity:0.3"></i>
   <p>No pending requests</p>
  </div>
 {% endif %}
</div>

{% endblock %}
